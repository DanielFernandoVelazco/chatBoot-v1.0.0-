<div class="register-container">
    <div class="register-card">
        <!-- Logo -->
        <div class="logo-section">
            <span class="material-symbols-outlined logo-icon">chat_bubble</span>
            <h1 class="app-title">ChatApp</h1>
        </div>

        <!-- Formulario -->
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
            <h2 class="form-title">Crea tu cuenta</h2>
            <p class="form-subtitle">Únete a nuestra comunidad de chat.</p>

            <!-- Full Name -->
            <div class="form-group">
                <label>Nombre Completo</label>
                <input type="text" formControlName="fullName" placeholder="Introduce tu nombre completo"
                    class="form-input">
                <div class="error-message"
                    *ngIf="registerForm.get('fullName')?.hasError('required') && registerForm.get('fullName')?.touched">
                    El nombre completo es obligatorio
                </div>
            </div>

            <!-- Username -->
            <div class="form-group">
                <label>Nombre de Usuario</label>
                <input type="text" formControlName="username" placeholder="ej: juanperez" class="form-input"
                    (blur)="checkUsernameAvailability()">
                <div class="error-message"
                    *ngIf="registerForm.get('username')?.hasError('required') && registerForm.get('username')?.touched">
                    El nombre de usuario es obligatorio
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('username')?.hasError('minlength') && registerForm.get('username')?.touched">
                    El nombre de usuario debe tener al menos 3 caracteres
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('username')?.hasError('maxlength') && registerForm.get('username')?.touched">
                    El nombre de usuario no puede tener más de 20 caracteres
                </div>
                <div class="error-message" *ngIf="registerForm.get('username')?.hasError('notAvailable')">
                    Este nombre de usuario no está disponible
                </div>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label>Correo Electrónico</label>
                <input type="email" formControlName="email" placeholder="tu@email.com" class="form-input"
                    (blur)="checkEmailAvailability()">
                <div class="error-message"
                    *ngIf="registerForm.get('email')?.hasError('required') && registerForm.get('email')?.touched">
                    El email es obligatorio
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('email')?.hasError('email') && registerForm.get('email')?.touched">
                    El formato del email no es válido
                </div>
                <div class="error-message" *ngIf="registerForm.get('email')?.hasError('notAvailable')">
                    Este email ya está registrado
                </div>
            </div>

            <!-- Bio -->
            <div class="form-group">
                <label>Biografía (Opcional)</label>
                <textarea formControlName="bio" placeholder="Cuéntanos algo sobre ti..." class="form-input textarea"
                    rows="3"></textarea>
            </div>

            <!-- Password -->
            <div class="form-group">
                <label>Contraseña</label>
                <div class="password-input">
                    <input [type]="hidePassword ? 'password' : 'text'" formControlName="password"
                        placeholder="Introduce tu contraseña" class="form-input">
                    <button type="button" (click)="togglePasswordVisibility()" class="password-toggle">
                        <span class="material-symbols-outlined">
                            {{hidePassword ? 'visibility_off' : 'visibility'}}
                        </span>
                    </button>
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('password')?.hasError('required') && registerForm.get('password')?.touched">
                    La contraseña es obligatoria
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('password')?.hasError('minlength') && registerForm.get('password')?.touched">
                    La contraseña debe tener al menos 6 caracteres
                </div>
            </div>

            <!-- Confirm Password -->
            <div class="form-group">
                <label>Confirmar Contraseña</label>
                <div class="password-input">
                    <input [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword"
                        placeholder="Vuelve a introducir tu contraseña" class="form-input">
                    <button type="button" (click)="toggleConfirmPasswordVisibility()" class="password-toggle">
                        <span class="material-symbols-outlined">
                            {{hideConfirmPassword ? 'visibility_off' : 'visibility'}}
                        </span>
                    </button>
                </div>
                <div class="error-message"
                    *ngIf="registerForm.get('confirmPassword')?.hasError('required') && registerForm.get('confirmPassword')?.touched">
                    Debes confirmar tu contraseña
                </div>
                <div class="error-message"
                    *ngIf="registerForm.hasError('passwordMismatch') && registerForm.get('confirmPassword')?.touched">
                    Las contraseñas no coinciden
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="submit-button" [disabled]="!registerForm.valid || loading">
                <span *ngIf="!loading">Crear Cuenta</span>
                <span *ngIf="loading">Creando cuenta...</span>
            </button>

            <!-- Terms -->
            <p class="terms-text">
                Al registrarte, aceptas nuestros
                <a href="#" class="terms-link">Términos de Servicio</a>.
            </p>

            <!-- Login Link -->
            <p class="login-link">
                ¿Ya tienes una cuenta?
                <a (click)="navigateToLogin()">Inicia sesión</a>
            </p>
        </form>
    </div>
</div>