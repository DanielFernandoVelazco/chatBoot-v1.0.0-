<div class="chat-container">
    <!-- Sidebar -->
    <aside class="sidebar" [class.sidebar-collapsed]="!isSidebarOpen">
        <!-- Sidebar Header -->
        <div class="sidebar-header">
            <div class="user-info" *ngIf="currentUser">
                <div class="user-avatar">
                    <img [src]="currentUser.profilePicture" [alt]="currentUser.fullName">
                </div>
                <div class="user-details">
                    <h3 class="user-name">{{ currentUser.fullName }}</h3>
                    <p class="user-status">{{ currentUser.status }}</p>
                </div>
            </div>
            <button class="sidebar-toggle" (click)="toggleSidebar()">
                <span class="material-symbols-outlined">
                    {{ isSidebarOpen ? 'menu_open' : 'menu' }}
                </span>
            </button>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-input">
                <span class="material-symbols-outlined search-icon">search</span>
                <input type="text" placeholder="Buscar contactos..." [(ngModel)]="searchQuery" class="search-field">
            </div>
        </div>

        <!-- New Chat Button -->
        <button class="new-chat-button" (click)="createNewChat()">
            <span class="material-symbols-outlined">add</span>
            <span>Nuevo Chat</span>
        </button>

        <!-- Chats List -->
        <div class="chats-list">
            <div *ngFor="let chat of chats" class="chat-item" [class.active]="selectedChat?.id === chat.id"
                (click)="selectChat(chat)">

                <div class="chat-avatar">
                    <img [src]="'https://via.placeholder.com/150'" [alt]="getChatDisplayName(chat)">
                </div>

                <div class="chat-info">
                    <div class="chat-header">
                        <h4 class="chat-name">{{ getChatDisplayName(chat) }}</h4>
                        <span class="chat-time">{{ getChatTime(chat) }}</span>
                    </div>
                    <p class="chat-last-message">{{ getChatLastMessage(chat) }}</p>
                </div>
            </div>
        </div>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            <button class="logout-button" (click)="logout()">
                <span class="material-symbols-outlined">logout</span>
                <span>Cerrar Sesión</span>
            </button>
        </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
        <!-- Chat Header -->
        <header class="chat-header" *ngIf="selectedChat">
            <div class="chat-partner-info">
                <div class="partner-avatar">
                    <img [src]="'https://via.placeholder.com/150'" [alt]="getChatDisplayName(selectedChat)">
                </div>
                <div class="partner-details">
                    <h2 class="partner-name">{{ getChatDisplayName(selectedChat) }}</h2>
                    <p class="partner-status" *ngIf="selectedChat.type === 'PRIVATE'">En línea</p>
                    <p class="partner-status" *ngIf="selectedChat.type === 'GROUP'">
                        {{ selectedChat.participantIds.length }} miembros
                    </p>
                </div>
            </div>

            <div class="chat-actions">
                <button class="action-button">
                    <span class="material-symbols-outlined">call</span>
                </button>
                <button class="action-button">
                    <span class="material-symbols-outlined">videocam</span>
                </button>
                <button class="action-button">
                    <span class="material-symbols-outlined">more_vert</span>
                </button>
            </div>
        </header>

        <!-- Chat Messages Area -->
        <div class="messages-container" *ngIf="selectedChat; else noChatSelected">
            <div class="messages-placeholder">
                <div class="placeholder-icon">
                    <span class="material-symbols-outlined">chat_bubble</span>
                </div>
                <h3>Chat seleccionado</h3>
                <p>Los mensajes aparecerán aquí cuando implementemos el chat en tiempo real.</p>
            </div>
        </div>

        <!-- No Chat Selected -->
        <ng-template #noChatSelected>
            <div class="no-chat-selected">
                <div class="welcome-icon">
                    <span class="material-symbols-outlined">chat_bubble</span>
                </div>
                <h2>Bienvenido a ChatApp</h2>
                <p>Selecciona un chat para empezar a conversar o crea uno nuevo.</p>
            </div>
        </ng-template>

        <!-- Message Input -->
        <footer class="message-input-container" *ngIf="selectedChat">
            <div class="input-actions">
                <button class="input-action-button">
                    <span class="material-symbols-outlined">add_circle</span>
                </button>
            </div>

            <div class="message-input">
                <input type="text" placeholder="Escribe un mensaje..." class="message-field">
            </div>

            <div class="send-actions">
                <button class="send-button">
                    <span class="material-symbols-outlined">send</span>
                </button>
            </div>
        </footer>
    </main>
</div>